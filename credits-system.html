<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Credits & XP System - Binary Ring AI</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(135deg, #0c0c0c 0%, #1a1a2e 50%, #16213e 100%);
            color: white;
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 30px;
        }

        .logo {
            font-size: 28px;
            font-weight: bold;
            background: linear-gradient(45deg, #00d4ff, #ff6b6b, #4ecdc4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .credits-display {
            display: flex;
            align-items: center;
            gap: 20px;
            background: rgba(255, 255, 255, 0.05);
            padding: 12px 24px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .svg-export-btn {
            background: linear-gradient(45deg, #9c27b0, #673ab7);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .svg-export-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(156, 39, 176, 0.3);
        }

        .export-menu {
            position: absolute;
            top: 100%;
            right: 0;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            padding: 10px 0;
            min-width: 200px;
            z-index: 1000;
            display: none;
        }

        .export-menu.show {
            display: block;
        }

        .export-option {
            padding: 10px 15px;
            cursor: pointer;
            transition: background 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
            color: white;
        }

        .export-option:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .credit-counter {
            font-size: 24px;
            font-weight: bold;
            color: #00d4ff;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .xp-counter {
            font-size: 18px;
            color: #4ecdc4;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .level-badge {
            background: linear-gradient(45deg, #ff6b6b, #ffa500);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: bold;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .section {
            background: rgba(255, 255, 255, 0.05);
            padding: 25px;
            border-radius: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .section-title {
            font-size: 22px;
            font-weight: bold;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .upload-zone {
            border: 2px dashed rgba(255, 255, 255, 0.3);
            padding: 40px;
            border-radius: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 20px;
        }

        .upload-zone:hover {
            border-color: #00d4ff;
            background: rgba(0, 212, 255, 0.05);
        }

        .upload-zone.dragover {
            border-color: #ff6b6b;
            background: rgba(255, 107, 107, 0.1);
            transform: scale(1.02);
        }

        .analysis-levels {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 20px;
        }

        .level-card {
            background: rgba(255, 255, 255, 0.03);
            padding: 15px;
            border-radius: 12px;
            border-left: 4px solid transparent;
            transition: all 0.3s ease;
        }

        .level-1 { border-left-color: #4CAF50; }
        .level-2 { border-left-color: #2196F3; }
        .level-3 { border-left-color: #FF9800; }
        .level-4 { border-left-color: #E91E63; }

        .level-card.active {
            background: rgba(255, 255, 255, 0.08);
            transform: translateX(5px);
        }

        .level-title {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .level-credits {
            color: #00d4ff;
            font-weight: bold;
            float: right;
        }

        .url-input {
            width: 100%;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            color: white;
            font-size: 16px;
            margin-bottom: 15px;
        }

        .url-input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        .analyze-btn {
            background: linear-gradient(45deg, #00d4ff, #0099cc);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
        }

        .analyze-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 212, 255, 0.3);
        }

        .analyze-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .sections-display {
            margin-top: 15px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 10px;
            min-height: 100px;
        }

        .section-item {
            padding: 8px 12px;
            margin: 5px 0;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 6px;
            border-left: 3px solid #4CAF50;
        }

        .sets-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-top: 20px;
        }

        .set-card {
            background: rgba(255, 255, 255, 0.03);
            padding: 15px;
            border-radius: 12px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .set-card:hover {
            background: rgba(255, 255, 255, 0.08);
            transform: translateY(-3px);
        }

        .set-card.selected {
            border-color: #4ecdc4;
            background: rgba(78, 205, 196, 0.1);
        }

        .set-icon {
            font-size: 30px;
            margin-bottom: 10px;
        }

        .set-title {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .set-xp {
            color: #4ecdc4;
            font-size: 14px;
        }

        .achievements {
            grid-column: 1 / -1;
            margin-top: 20px;
        }

        .achievement-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .achievement-card {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .achievement-card.unlocked {
            background: linear-gradient(45deg, rgba(255, 215, 0, 0.1), rgba(255, 193, 7, 0.1));
            border-color: #FFD700;
            box-shadow: 0 5px 20px rgba(255, 215, 0, 0.2);
        }

        .achievement-icon {
            font-size: 40px;
            margin-bottom: 10px;
        }

        .achievement-title {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .achievement-desc {
            color: rgba(255, 255, 255, 0.7);
            font-size: 14px;
        }

        .progress-bar {
            width: 100%;
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            margin-top: 10px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(45deg, #00d4ff, #4ecdc4);
            border-radius: 3px;
            transition: width 0.5s ease;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
            padding: 15px 20px;
            border-radius: 10px;
            transform: translateX(400px);
            transition: transform 0.3s ease;
            z-index: 1000;
            max-width: 300px;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.credits {
            background: linear-gradient(45deg, #00d4ff, #0099cc);
        }

        .notification.xp {
            background: linear-gradient(45deg, #4ecdc4, #45b7aa);
        }

        .particles {
            position: absolute;
            pointer-events: none;
            z-index: 999;
        }

        .particle {
            position: absolute;
            font-size: 20px;
            font-weight: bold;
            color: #00d4ff;
            animation: floatUp 2s ease-out forwards;
        }

        @keyframes floatUp {
            0% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
            100% {
                opacity: 0;
                transform: translateY(-100px) scale(1.5);
            }
        }

        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
        }

        .pulse {
            animation: pulse 0.5s ease-in-out;
        }

        .svg-export-btn {
            background: linear-gradient(45deg, #4ecdc4, #45b7aa);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .svg-export-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(78, 205, 196, 0.3);
        }

        .export-menu {
            display: none;
            position: absolute;
            top: 100%;
            right: 0;
            background: rgba(0, 0, 0, 0.9);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            padding: 10px 0;
            min-width: 180px;
            z-index: 1000;
            backdrop-filter: blur(10px);
            margin-top: 5px;
        }

        .export-option {
            padding: 10px 20px;
            color: white;
            cursor: pointer;
            transition: background 0.2s ease;
            font-size: 14px;
        }

        .export-option:hover {
            background: rgba(78, 205, 196, 0.2);
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }

            .credits-display {
                flex-direction: column;
                gap: 10px;
            }

            .analysis-levels {
                grid-template-columns: 1fr;
            }

            .sets-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .export-menu {
                right: auto;
                left: 0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo">Binary Ring AI Credits</div>
            <div class="credits-display">
                <div class="credit-counter">
                    üí∞ <span id="creditCount">0</span>
                </div>
                <div class="xp-counter">
                    ‚ö° <span id="xpCount">0</span> XP
                </div>
                <div class="level-badge" id="levelBadge">Level 1</div>
                <div style="position: relative;">
                    <button class="svg-export-btn" onclick="toggleExportMenu()">
                        üìä Export SVG
                    </button>
                    <div class="export-menu" id="exportMenu">
                        <div class="export-option" onclick="exportProfileCard()">
                            üë§ Profile Card
                        </div>
                        <div class="export-option" onclick="exportAchievements()">
                            üèÜ Achievement Badges
                        </div>
                        <div class="export-option" onclick="exportProgressChart()">
                            üìà Progress Chart
                        </div>
                        <div class="export-option" onclick="exportPhotoAnalysis()">
                            üì∏ Photo Analysis
                        </div>
                        <div class="export-option" onclick="exportTimeline()">
                            ‚è∞ Activity Timeline
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="main-content">
            <!-- Photo Upload Analysis -->
            <div class="section">
                <div class="section-title">üì∏ Photo Analysis System</div>
                <div class="upload-zone" id="photoUpload">
                    <div style="font-size: 48px; margin-bottom: 10px;">üì∑</div>
                    <h3>Drop photo here or click to upload</h3>
                    <p>Get credits based on AI analysis complexity</p>
                    <input type="file" id="fileInput" accept="image/*" style="display: none;">
                </div>

                <div class="analysis-levels">
                    <div class="level-card level-1" id="level1">
                        <div class="level-title">Level 1 - Basic</div>
                        <div class="level-credits">+100</div>
                        <div style="clear: both; color: rgba(255,255,255,0.7); font-size: 12px; margin-top: 5px;">
                            Objects, colors detection
                        </div>
                    </div>
                    <div class="level-card level-2" id="level2">
                        <div class="level-title">Level 2 - Intermediate</div>
                        <div class="level-credits">+250</div>
                        <div style="clear: both; color: rgba(255,255,255,0.7); font-size: 12px; margin-top: 5px;">
                            Composition, lighting analysis
                        </div>
                    </div>
                    <div class="level-card level-3" id="level3">
                        <div class="level-title">Level 3 - Advanced</div>
                        <div class="level-credits">+500</div>
                        <div style="clear: both; color: rgba(255,255,255,0.7); font-size: 12px; margin-top: 5px;">
                            Mood, emotion, artistic elements
                        </div>
                    </div>
                    <div class="level-card level-4" id="level4">
                        <div class="level-title">Level 4 - Expert</div>
                        <div class="level-credits">+750</div>
                        <div style="clear: both; color: rgba(255,255,255,0.7); font-size: 12px; margin-top: 5px;">
                            Complex patterns, AI insights
                        </div>
                    </div>
                </div>
            </div>

            <!-- Link Analysis System -->
            <div class="section">
                <div class="section-title">üîó Link Analysis System</div>
                <input type="url" class="url-input" id="urlInput" placeholder="Enter URL to analyze...">
                <button class="analyze-btn" id="analyzeBtn" onclick="analyzeLink()">Analyze Link Structure</button>

                <div class="sections-display" id="sectionsDisplay">
                    <div style="text-align: center; color: rgba(255,255,255,0.5); padding: 20px;">
                        Enter a URL above to analyze its sections and earn credits
                        <br><br>
                        <strong>üí∞ Rewards:</strong><br>
                        12+ sections = 1000 credits<br>
                        6-11 sections = 500 credits<br>
                        1-5 sections = 100 credits
                    </div>
                </div>
            </div>

            <!-- Sets & Subsets XP -->
            <div class="section">
                <div class="section-title">üìä Sets & Subsets XP System</div>
                <p style="color: rgba(255,255,255,0.7); margin-bottom: 20px;">
                    Organize content into categories and earn XP points
                </p>

                <div class="sets-grid">
                    <div class="set-card" onclick="createSet('design')">
                        <div class="set-icon">üé®</div>
                        <div class="set-title">Design Set</div>
                        <div class="set-xp">+50 XP</div>
                    </div>
                    <div class="set-card" onclick="createSet('tech')">
                        <div class="set-icon">üíª</div>
                        <div class="set-title">Tech Set</div>
                        <div class="set-xp">+50 XP</div>
                    </div>
                    <div class="set-card" onclick="createSet('media')">
                        <div class="set-icon">üé¨</div>
                        <div class="set-title">Media Set</div>
                        <div class="set-xp">+50 XP</div>
                    </div>
                    <div class="set-card" onclick="createSubset('colors')">
                        <div class="set-icon">üåà</div>
                        <div class="set-title">Color Subset</div>
                        <div class="set-xp">+25 XP</div>
                    </div>
                    <div class="set-card" onclick="createSubset('typography')">
                        <div class="set-icon">üìù</div>
                        <div class="set-title">Type Subset</div>
                        <div class="set-xp">+25 XP</div>
                    </div>
                    <div class="set-card" onclick="createConnection()">
                        <div class="set-icon">üîó</div>
                        <div class="set-title">Connection</div>
                        <div class="set-xp">+75 XP</div>
                    </div>
                </div>
            </div>

            <!-- Achievements System -->
            <div class="section achievements">
                <div class="section-title">üèÜ Achievements</div>

                <div class="achievement-grid">
                    <div class="achievement-card" id="achievement1">
                        <div class="achievement-icon">ü•â</div>
                        <div class="achievement-title">First Upload</div>
                        <div class="achievement-desc">Upload your first photo</div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="progress1" style="width: 0%;"></div>
                        </div>
                    </div>

                    <div class="achievement-card" id="achievement2">
                        <div class="achievement-icon">ü•à</div>
                        <div class="achievement-title">Link Master</div>
                        <div class="achievement-desc">Analyze 5 complex links</div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="progress2" style="width: 0%;"></div>
                        </div>
                    </div>

                    <div class="achievement-card" id="achievement3">
                        <div class="achievement-icon">ü•á</div>
                        <div class="achievement-title">Set Organizer</div>
                        <div class="achievement-desc">Create 10 sets or subsets</div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="progress3" style="width: 0%;"></div>
                        </div>
                    </div>

                    <div class="achievement-card" id="achievement4">
                        <div class="achievement-icon">üíé</div>
                        <div class="achievement-title">Credit Millionaire</div>
                        <div class="achievement-desc">Earn 10,000 total credits</div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="progress4" style="width: 0%;"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Notification System -->
    <div class="notification" id="notification"></div>

    <!-- Particles Container -->
    <div class="particles" id="particles"></div>

    <script>
        // Game State
        let gameState = {
            credits: 0,
            xp: 0,
            level: 1,
            achievements: {
                firstUpload: false,
                linkMaster: 0,
                setOrganizer: 0,
                creditMillionaire: false
            }
        };

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            loadGameState();
            updateDisplay();
            setupEventListeners();
        });

        function setupEventListeners() {
            const photoUpload = document.getElementById('photoUpload');
            const fileInput = document.getElementById('fileInput');

            photoUpload.addEventListener('click', () => fileInput.click());
            photoUpload.addEventListener('dragover', handleDragOver);
            photoUpload.addEventListener('drop', handleDrop);
            fileInput.addEventListener('change', handleFileSelect);
        }

        function handleDragOver(e) {
            e.preventDefault();
            e.currentTarget.classList.add('dragover');
        }

        function handleDrop(e) {
            e.preventDefault();
            e.currentTarget.classList.remove('dragover');
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                analyzePhoto(files[0]);
            }
        }

        function handleFileSelect(e) {
            if (e.target.files.length > 0) {
                analyzePhoto(e.target.files[0]);
            }
        }

        function analyzePhoto(file) {
            showNotification('Analyzing photo...', 'credits');

            // Simulate AI analysis with progressive levels
            setTimeout(() => activateLevel('level1', 100), 500);
            setTimeout(() => activateLevel('level2', 250), 1000);
            setTimeout(() => activateLevel('level3', 500), 1500);
            setTimeout(() => activateLevel('level4', 750), 2000);

            // Check first upload achievement
            if (!gameState.achievements.firstUpload) {
                gameState.achievements.firstUpload = true;
                unlockAchievement('achievement1', 'First Upload Unlocked!');
            }
        }

        function activateLevel(levelId, credits) {
            const level = document.getElementById(levelId);
            level.classList.add('active');

            // Add credits with animation
            addCredits(credits);
            createParticles(level, `+${credits}`);

            setTimeout(() => level.classList.remove('active'), 1000);
        }

        async function analyzeLink() {
            const urlInput = document.getElementById('urlInput');
            const url = urlInput.value.trim();

            if (!url) {
                showNotification('Please enter a valid URL', 'error');
                return;
            }

            const analyzeBtn = document.getElementById('analyzeBtn');
            analyzeBtn.disabled = true;
            analyzeBtn.textContent = 'Analyzing...';

            // Simulate link analysis
            setTimeout(() => {
                const sectionCount = Math.floor(Math.random() * 20) + 1;
                displaySections(sectionCount);

                let credits = 0;
                if (sectionCount >= 12) {
                    credits = 1000;
                    showNotification('üéâ Full reward! 12+ sections found!', 'credits');
                } else if (sectionCount >= 6) {
                    credits = 500;
                    showNotification('Good analysis! 6-11 sections found!', 'credits');
                } else {
                    credits = 100;
                    showNotification('Basic analysis complete!', 'credits');
                }

                addCredits(credits);

                // Update link master achievement
                gameState.achievements.linkMaster++;
                updateAchievementProgress('achievement2', gameState.achievements.linkMaster, 5);

                if (gameState.achievements.linkMaster >= 5) {
                    unlockAchievement('achievement2', 'Link Master Unlocked!');
                }

                analyzeBtn.disabled = false;
                analyzeBtn.textContent = 'Analyze Link Structure';
            }, 2000);
        }

        function displaySections(count) {
            const display = document.getElementById('sectionsDisplay');
            const sections = [
                'Header Navigation', 'Hero Section', 'About Us', 'Services', 'Portfolio',
                'Testimonials', 'Contact', 'Footer', 'Sidebar', 'Blog Posts',
                'Gallery', 'Team Members', 'Pricing', 'FAQ', 'Newsletter',
                'Social Media', 'Search', 'Categories', 'Archives', 'Related Content'
            ];

            display.innerHTML = `<h4 style="margin-bottom: 15px;">Found ${count} sections:</h4>`;

            for (let i = 0; i < count; i++) {
                const section = document.createElement('div');
                section.className = 'section-item';
                section.textContent = sections[i % sections.length];
                display.appendChild(section);
            }
        }

        function createSet(type) {
            addXP(50);
            showNotification(`${type} set created! +50 XP`, 'xp');

            // Update set organizer achievement
            gameState.achievements.setOrganizer++;
            updateAchievementProgress('achievement3', gameState.achievements.setOrganizer, 10);

            if (gameState.achievements.setOrganizer >= 10) {
                unlockAchievement('achievement3', 'Set Organizer Unlocked!');
            }
        }

        function createSubset(type) {
            addXP(25);
            showNotification(`${type} subset created! +25 XP`, 'xp');

            gameState.achievements.setOrganizer++;
            updateAchievementProgress('achievement3', gameState.achievements.setOrganizer, 10);
        }

        function createConnection() {
            addXP(75);
            showNotification('Connection established! +75 XP', 'xp');
        }

        function addCredits(amount) {
            gameState.credits += amount;
            updateDisplay();
            saveGameState();

            // Check credit millionaire achievement
            if (gameState.credits >= 10000 && !gameState.achievements.creditMillionaire) {
                gameState.achievements.creditMillionaire = true;
                unlockAchievement('achievement4', 'Credit Millionaire Unlocked!');
            }

            updateAchievementProgress('achievement4', gameState.credits, 10000);
        }

        function addXP(amount) {
            gameState.xp += amount;

            // Level up logic
            const newLevel = Math.floor(gameState.xp / 1000) + 1;
            if (newLevel > gameState.level) {
                gameState.level = newLevel;
                showNotification(`üéâ Level Up! You are now level ${gameState.level}!`, 'xp');
            }

            updateDisplay();
            saveGameState();
        }

        function updateDisplay() {
            document.getElementById('creditCount').textContent = gameState.credits.toLocaleString();
            document.getElementById('xpCount').textContent = gameState.xp.toLocaleString();
            document.getElementById('levelBadge').textContent = `Level ${gameState.level}`;

            // Add pulse animation to counters
            document.getElementById('creditCount').classList.add('pulse');
            setTimeout(() => document.getElementById('creditCount').classList.remove('pulse'), 500);
        }

        function createParticles(element, text) {
            const particles = document.getElementById('particles');
            const rect = element.getBoundingClientRect();

            for (let i = 0; i < 3; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.textContent = text;
                particle.style.left = (rect.left + Math.random() * rect.width) + 'px';
                particle.style.top = rect.top + 'px';

                particles.appendChild(particle);

                setTimeout(() => particle.remove(), 2000);
            }
        }

        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type} show`;

            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        function unlockAchievement(achievementId, message) {
            const achievement = document.getElementById(achievementId);
            achievement.classList.add('unlocked');
            showNotification(message, 'xp');
            updateAchievementProgress(achievementId, 1, 1);
        }

        function updateAchievementProgress(achievementId, current, target) {
            const progressId = achievementId.replace('achievement', 'progress');
            const progress = document.getElementById(progressId);
            const percentage = Math.min((current / target) * 100, 100);
            progress.style.width = percentage + '%';
        }

        function saveGameState() {
            localStorage.setItem('binaryRingCredits', JSON.stringify(gameState));
        }

        function loadGameState() {
            const saved = localStorage.getItem('binaryRingCredits');
            if (saved) {
                gameState = { ...gameState, ...JSON.parse(saved) };
            }
        }

        // Daily bonus system
        function checkDailyBonus() {
            const lastBonus = localStorage.getItem('lastDailyBonus');
            const today = new Date().toDateString();

            if (lastBonus !== today) {
                const bonus = Math.floor(Math.random() * 400) + 100; // 100-500 credits
                addCredits(bonus);
                showNotification(`Daily Bonus: +${bonus} credits!`, 'credits');
                localStorage.setItem('lastDailyBonus', today);
            }
        }

        // Check daily bonus on load
        setTimeout(checkDailyBonus, 1000);

        // Auto-save every 30 seconds
        setInterval(saveGameState, 30000);

        // SVG Export Functions with OTR Lines (Outline/Trace Lines)
        function toggleExportMenu() {
            const menu = document.getElementById('exportMenu');
            menu.style.display = menu.style.display === 'block' ? 'none' : 'block';
        }

        function createBaseSVG(width = 800, height = 600, title = 'Binary Ring Export') {
            return `<?xml version="1.0" encoding="UTF-8"?>
<svg width="${width}" height="${height}" viewBox="0 0 ${width} ${height}" xmlns="http://www.w3.org/2000/svg">
    <defs>
        <linearGradient id="bgGrad" x1="0%" y1="0%" x2="100%" y2="100%">
            <stop offset="0%" style="stop-color:#0c0c0c;stop-opacity:1" />
            <stop offset="50%" style="stop-color:#1a1a2e;stop-opacity:1" />
            <stop offset="100%" style="stop-color:#16213e;stop-opacity:1" />
        </linearGradient>
        <linearGradient id="creditGrad" x1="0%" y1="0%" x2="100%" y2="0%">
            <stop offset="0%" style="stop-color:#00d4ff;stop-opacity:1" />
            <stop offset="100%" style="stop-color:#4ecdc4;stop-opacity:1" />
        </linearGradient>
        <filter id="glow">
            <feGaussianBlur stdDeviation="3" result="coloredBlur"/>
            <feMerge>
                <feMergeNode in="coloredBlur"/>
                <feMergeNode in="SourceGraphic"/>
            </feMerge>
        </filter>
        <style>
            .title-text { font: bold 24px Arial; fill: white; }
            .credit-text { font: bold 18px Arial; fill: #00d4ff; }
            .xp-text { font: 16px Arial; fill: #4ecdc4; }
            .level-text { font: bold 14px Arial; fill: #ff6b6b; }
            .otr-line { stroke: #00d4ff; stroke-width: 2; fill: none; opacity: 0.6; }
            .trace-line { stroke: #4ecdc4; stroke-width: 1; fill: none; stroke-dasharray: 5,5; }
            .outline { stroke: rgba(255,255,255,0.3); stroke-width: 1; fill: none; }
        </style>
    </defs>
    <rect width="100%" height="100%" fill="url(#bgGrad)"/>
    <title>${title}</title>`;
        }

        function exportProfileCard() {
            const svg = createBaseSVG(400, 300, 'Profile Card');

            const content = `
    <!-- OTR Lines Framework -->
    <path d="M 20 20 L 380 20 L 380 280 L 20 280 Z" class="outline"/>
    <path d="M 30 50 L 370 50" class="otr-line"/>
    <path d="M 30 100 L 370 100" class="trace-line"/>

    <!-- Profile Content -->
    <text x="200" y="40" text-anchor="middle" class="title-text">Binary Ring Credits</text>

    <!-- Stats Box -->
    <rect x="50" y="70" width="120" height="80" rx="10" fill="rgba(255,255,255,0.1)" stroke="rgba(255,255,255,0.3)"/>
    <text x="110" y="95" text-anchor="middle" class="credit-text">${gameState.credits.toLocaleString()}</text>
    <text x="110" y="115" text-anchor="middle" class="credit-text">Credits</text>
    <text x="110" y="135" text-anchor="middle" class="xp-text">${gameState.xp.toLocaleString()} XP</text>

    <!-- Level Badge -->
    <rect x="230" y="70" width="120" height="80" rx="10" fill="rgba(255,107,107,0.2)" stroke="#ff6b6b"/>
    <text x="290" y="95" text-anchor="middle" class="level-text">Level ${gameState.level}</text>

    <!-- Achievement Indicators -->
    <text x="50" y="180" class="xp-text">Achievements:</text>
    ${Object.entries(gameState.achievements).map((achievement, i) =>
        `<circle cx="${70 + i * 30}" cy="200" r="8" fill="${achievement[1] ? '#4CAF50' : '#666'}" stroke="white"/>`
    ).join('')}

    <!-- Trace Lines connecting elements -->
    <path d="M 170 110 Q 200 110 230 110" class="trace-line"/>
    <path d="M 110 150 Q 150 170 110 190" class="trace-line"/>

    <!-- Border frame -->
    <rect x="10" y="10" width="380" height="280" rx="15" fill="none" stroke="url(#creditGrad)" stroke-width="2"/>
</svg>`;

            downloadSVG(svg + content, 'binary-ring-profile.svg');
        }

        function exportAchievements() {
            const svg = createBaseSVG(600, 400, 'Achievement Badges');

            const achievements = [
                { name: 'First Upload', unlocked: gameState.achievements.firstUpload, icon: 'ü•â', x: 100, y: 100 },
                { name: 'Link Master', unlocked: gameState.achievements.linkMaster >= 5, icon: 'ü•à', x: 300, y: 100 },
                { name: 'Set Organizer', unlocked: gameState.achievements.setOrganizer >= 10, icon: 'ü•á', x: 500, y: 100 },
                { name: 'Credit Millionaire', unlocked: gameState.achievements.creditMillionaire, icon: 'üíé', x: 300, y: 250 }
            ];

            let content = `
    <!-- Title -->
    <text x="300" y="40" text-anchor="middle" class="title-text">Achievement Collection</text>

    <!-- OTR Connection Lines -->
    <path d="M 100 100 L 300 100 L 500 100" class="otr-line"/>
    <path d="M 300 100 L 300 250" class="otr-line"/>
    `;

            achievements.forEach((ach, i) => {
                const color = ach.unlocked ? '#FFD700' : '#666666';
                content += `
    <!-- Achievement ${i + 1} -->
    <circle cx="${ach.x}" cy="${ach.y}" r="40" fill="${color}" stroke="white" stroke-width="3" filter="url(#glow)"/>
    <circle cx="${ach.x}" cy="${ach.y}" r="35" fill="none" stroke="rgba(255,255,255,0.5)" stroke-width="1" class="outline"/>
    <text x="${ach.x}" y="${ach.y + 8}" text-anchor="middle" font-size="24">${ach.icon}</text>
    <text x="${ach.x}" y="${ach.y + 65}" text-anchor="middle" class="xp-text">${ach.name}</text>

    <!-- Trace lines around badge -->
    <path d="M ${ach.x - 25} ${ach.y - 25} Q ${ach.x} ${ach.y - 35} ${ach.x + 25} ${ach.y - 25}" class="trace-line"/>
                `;
            });

            content += '</svg>';
            downloadSVG(svg + content, 'binary-ring-achievements.svg');
        }

        function exportProgressChart() {
            const svg = createBaseSVG(700, 500, 'Progress Chart');

            // Generate mock progress data
            const days = 30;
            const creditsData = Array.from({length: days}, (_, i) => ({
                day: i + 1,
                credits: Math.floor(gameState.credits * (i + 1) / days),
                xp: Math.floor(gameState.xp * (i + 1) / days)
            }));

            const maxCredits = Math.max(...creditsData.map(d => d.credits));
            const maxXp = Math.max(...creditsData.map(d => d.xp));

            let content = `
    <!-- Title -->
    <text x="350" y="40" text-anchor="middle" class="title-text">30-Day Progress Chart</text>

    <!-- Chart Area -->
    <rect x="80" y="70" width="540" height="350" fill="rgba(255,255,255,0.05)" stroke="rgba(255,255,255,0.3)" rx="10"/>

    <!-- Grid Lines (OTR Lines) -->`;

            for (let i = 0; i <= 5; i++) {
                const y = 70 + (i * 350 / 5);
                content += `<line x1="80" y1="${y}" x2="620" y2="${y}" class="otr-line"/>`;
            }

            for (let i = 0; i <= 6; i++) {
                const x = 80 + (i * 540 / 6);
                content += `<line x1="${x}" y1="70" x2="${x}" y2="420" class="trace-line"/>`;
            }

            // Credits line
            let creditsPath = 'M ';
            creditsData.forEach((data, i) => {
                const x = 80 + (i * 540 / (days - 1));
                const y = 420 - (data.credits / maxCredits * 350);
                creditsPath += `${i === 0 ? '' : 'L '}${x} ${y} `;
            });

            // XP line
            let xpPath = 'M ';
            creditsData.forEach((data, i) => {
                const x = 80 + (i * 540 / (days - 1));
                const y = 420 - (data.xp / maxXp * 350);
                xpPath += `${i === 0 ? '' : 'L '}${x} ${y} `;
            });

            content += `
    <!-- Progress Lines -->
    <path d="${creditsPath}" stroke="#00d4ff" stroke-width="3" fill="none" filter="url(#glow)"/>
    <path d="${xpPath}" stroke="#4ecdc4" stroke-width="3" fill="none" filter="url(#glow)"/>

    <!-- Legend -->
    <rect x="500" y="90" width="100" height="60" fill="rgba(0,0,0,0.7)" stroke="rgba(255,255,255,0.3)" rx="5"/>
    <line x1="510" y1="110" x2="530" y2="110" stroke="#00d4ff" stroke-width="3"/>
    <text x="535" y="115" class="credit-text">Credits</text>
    <line x1="510" y1="130" x2="530" y2="130" stroke="#4ecdc4" stroke-width="3"/>
    <text x="535" y="135" class="xp-text">XP</text>

    <!-- Labels -->
    <text x="350" y="450" text-anchor="middle" class="xp-text">Days</text>
    <text x="50" y="250" text-anchor="middle" class="xp-text" transform="rotate(-90 50 250)">Progress</text>
</svg>`;

            downloadSVG(svg + content, 'binary-ring-progress.svg');
        }

        function exportPhotoAnalysis() {
            const svg = createBaseSVG(500, 400, 'Photo Analysis Results');

            const levels = [
                { name: 'Basic', credits: 100, color: '#4CAF50', y: 120 },
                { name: 'Intermediate', credits: 250, color: '#2196F3', y: 170 },
                { name: 'Advanced', credits: 500, color: '#FF9800', y: 220 },
                { name: 'Expert', credits: 750, color: '#E91E63', y: 270 }
            ];

            let content = `
    <!-- Title -->
    <text x="250" y="40" text-anchor="middle" class="title-text">AI Photo Analysis Levels</text>

    <!-- Analysis Framework -->
    <rect x="50" y="80" width="400" height="280" fill="rgba(255,255,255,0.05)" stroke="rgba(255,255,255,0.3)" rx="15"/>
    `;

            levels.forEach((level, i) => {
                const barWidth = (level.credits / 750) * 300;
                content += `
    <!-- Level ${i + 1} -->
    <rect x="70" y="${level.y}" width="${barWidth}" height="30" fill="${level.color}" opacity="0.7" rx="3"/>
    <rect x="70" y="${level.y}" width="300" height="30" fill="none" stroke="${level.color}" stroke-width="1" class="outline" rx="3"/>
    <text x="80" y="${level.y + 20}" class="level-text">${level.name}</text>
    <text x="390" y="${level.y + 20}" class="credit-text">+${level.credits}</text>

    <!-- OTR connection line -->
    <path d="M 70 ${level.y + 15} L ${70 + barWidth} ${level.y + 15}" class="otr-line" stroke-width="1"/>
                `;
            });

            content += `
    <!-- Connecting trace lines -->
    <path d="M 380 135 Q 420 180 380 225 Q 420 250 380 285" class="trace-line"/>
</svg>`;

            downloadSVG(svg + content, 'binary-ring-photo-analysis.svg');
        }

        function exportTimeline() {
            const svg = createBaseSVG(800, 600, 'Activity Timeline');

            const activities = [
                { time: '5 min ago', action: 'Photo uploaded', credits: 750, x: 150, y: 150 },
                { time: '15 min ago', action: 'Link analyzed', credits: 1000, x: 300, y: 200 },
                { time: '1 hour ago', action: 'Set created', credits: 50, x: 450, y: 250 },
                { time: '2 hours ago', action: 'Achievement unlocked', credits: 0, x: 600, y: 300 }
            ];

            let content = `
    <!-- Title -->
    <text x="400" y="40" text-anchor="middle" class="title-text">Activity Timeline</text>

    <!-- Main timeline OTR line -->
    <path d="M 100 400 Q 200 350 300 400 Q 400 450 500 400 Q 600 350 700 400" class="otr-line" stroke-width="3"/>
    `;

            activities.forEach((activity, i) => {
                content += `
    <!-- Activity ${i + 1} -->
    <circle cx="${activity.x}" cy="400" r="15" fill="#00d4ff" stroke="white" stroke-width="2" filter="url(#glow)"/>
    <circle cx="${activity.x}" cy="400" r="10" fill="none" stroke="rgba(255,255,255,0.5)" class="outline"/>

    <!-- Activity details -->
    <rect x="${activity.x - 80}" y="${activity.y - 40}" width="160" height="70" fill="rgba(0,0,0,0.8)" stroke="rgba(255,255,255,0.3)" rx="8"/>
    <text x="${activity.x}" y="${activity.y - 20}" text-anchor="middle" class="xp-text">${activity.time}</text>
    <text x="${activity.x}" y="${activity.y}" text-anchor="middle" class="credit-text">${activity.action}</text>
    ${activity.credits > 0 ? `<text x="${activity.x}" y="${activity.y + 15}" text-anchor="middle" class="level-text">+${activity.credits}</text>` : ''}

    <!-- Connecting trace line -->
    <path d="M ${activity.x} 385 Q ${activity.x} ${(activity.y + 400) / 2} ${activity.x} ${activity.y + 30}" class="trace-line"/>
                `;
            });

            content += '</svg>';
            downloadSVG(svg + content, 'binary-ring-timeline.svg');
        }

        function downloadSVG(svgContent, filename) {
            const blob = new Blob([svgContent], { type: 'image/svg+xml;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = filename;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);

            showNotification(`SVG exported: ${filename}`, 'success');
        }

        // Close export menu when clicking outside
        document.addEventListener('click', function(e) {
            const menu = document.getElementById('exportMenu');
            const button = e.target.closest('.svg-export-btn');
            if (!button && menu) {
                menu.style.display = 'none';
            }
        });

        // SVG Export Functionality
        let lastPhotoAnalysis = null;
        let activityHistory = [];

        function toggleExportMenu() {
            const menu = document.getElementById('exportMenu');
            menu.classList.toggle('show');

            // Close menu when clicking outside
            document.addEventListener('click', function closeMenu(e) {
                if (!e.target.closest('.credits-display')) {
                    menu.classList.remove('show');
                    document.removeEventListener('click', closeMenu);
                }
            });
        }

        function generateSVG(content, width = 800, height = 600) {
            return `<?xml version="1.0" encoding="UTF-8"?>
<svg width="${width}" height="${height}" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <linearGradient id="bgGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#0c0c0c"/>
      <stop offset="50%" style="stop-color:#1a1a2e"/>
      <stop offset="100%" style="stop-color:#16213e"/>
    </linearGradient>
    <linearGradient id="creditGradient" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#00d4ff"/>
      <stop offset="100%" style="stop-color:#4ecdc4"/>
    </linearGradient>
    <linearGradient id="achievementGradient" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#FFD700"/>
      <stop offset="100%" style="stop-color:#FFA500"/>
    </linearGradient>
  </defs>
  <rect width="100%" height="100%" fill="url(#bgGradient)"/>
  ${content}
</svg>`;
        }

        function downloadSVG(filename, svgContent) {
            const blob = new Blob([svgContent], { type: 'image/svg+xml' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = filename;
            link.click();
            URL.revokeObjectURL(url);

            showNotification(`üìä ${filename} exported successfully!`, 'success');
        }

        function exportProfileCard() {
            const content = `
  <rect x="50" y="50" width="700" height="500" rx="20" fill="rgba(255,255,255,0.05)" stroke="rgba(255,255,255,0.2)"/>

  <!-- Header -->
  <text x="400" y="100" text-anchor="middle" fill="url(#creditGradient)" font-family="Arial, sans-serif" font-size="36" font-weight="bold">Binary Ring AI Profile</text>

  <!-- Stats -->
  <rect x="100" y="150" width="600" height="100" rx="15" fill="rgba(255,255,255,0.08)"/>
  <text x="150" y="185" fill="#00d4ff" font-family="Arial, sans-serif" font-size="24" font-weight="bold">üí∞ ${gameState.credits.toLocaleString()} Credits</text>
  <text x="150" y="215" fill="#4ecdc4" font-family="Arial, sans-serif" font-size="20">‚ö° ${gameState.xp.toLocaleString()} XP</text>
  <text x="450" y="185" fill="#ff6b6b" font-family="Arial, sans-serif" font-size="24" font-weight="bold">Level ${gameState.level}</text>
  <text x="450" y="215" fill="rgba(255,255,255,0.7)" font-family="Arial, sans-serif" font-size="16">Achievements: ${Object.values(gameState.achievements).filter(a => a === true || (typeof a === 'number' && a > 0)).length}</text>

  <!-- Achievement Icons -->
  <text x="100" y="300" fill="white" font-family="Arial, sans-serif" font-size="20" font-weight="bold">Recent Achievements:</text>
  ${gameState.achievements.firstUpload ? '<circle cx="150" cy="330" r="20" fill="url(#achievementGradient)"/><text x="150" y="340" text-anchor="middle" fill="black" font-size="16">ü•â</text>' : ''}
  ${gameState.achievements.linkMaster >= 5 ? '<circle cx="200" cy="330" r="20" fill="url(#achievementGradient)"/><text x="200" y="340" text-anchor="middle" fill="black" font-size="16">ü•à</text>' : ''}
  ${gameState.achievements.setOrganizer >= 10 ? '<circle cx="250" cy="330" r="20" fill="url(#achievementGradient)"/><text x="250" y="340" text-anchor="middle" fill="black" font-size="16">ü•á</text>' : ''}
  ${gameState.achievements.creditMillionaire ? '<circle cx="300" cy="330" r="20" fill="url(#achievementGradient)"/><text x="300" y="340" text-anchor="middle" fill="black" font-size="16">üíé</text>' : ''}

  <!-- Footer -->
  <text x="400" y="480" text-anchor="middle" fill="rgba(255,255,255,0.5)" font-family="Arial, sans-serif" font-size="14">Generated ${new Date().toLocaleString()}</text>
  <text x="400" y="500" text-anchor="middle" fill="rgba(255,255,255,0.5)" font-family="Arial, sans-serif" font-size="12">binary-ring.ai</text>`;

            const svg = generateSVG(content, 800, 550);
            downloadSVG(`profile-card-${Date.now()}.svg`, svg);
        }

        function exportAchievements() {
            const achievements = [
                { name: 'First Upload', icon: 'ü•â', unlocked: gameState.achievements.firstUpload, progress: gameState.achievements.firstUpload ? 100 : 0 },
                { name: 'Link Master', icon: 'ü•à', unlocked: gameState.achievements.linkMaster >= 5, progress: Math.min((gameState.achievements.linkMaster / 5) * 100, 100) },
                { name: 'Set Organizer', icon: 'ü•á', unlocked: gameState.achievements.setOrganizer >= 10, progress: Math.min((gameState.achievements.setOrganizer / 10) * 100, 100) },
                { name: 'Credit Millionaire', icon: 'üíé', unlocked: gameState.achievements.creditMillionaire, progress: Math.min((gameState.credits / 10000) * 100, 100) }
            ];

            let content = `
  <text x="400" y="50" text-anchor="middle" fill="url(#creditGradient)" font-family="Arial, sans-serif" font-size="32" font-weight="bold">Achievement Badges</text>`;

            achievements.forEach((achievement, index) => {
                const x = 100 + (index % 2) * 350;
                const y = 120 + Math.floor(index / 2) * 150;

                content += `
  <!-- Achievement ${index + 1} -->
  <rect x="${x}" y="${y}" width="300" height="120" rx="15" fill="${achievement.unlocked ? 'rgba(255, 215, 0, 0.1)' : 'rgba(255,255,255,0.05)'}" stroke="${achievement.unlocked ? '#FFD700' : 'rgba(255,255,255,0.2)'}"/>
  <circle cx="${x + 30}" cy="${y + 35}" r="20" fill="${achievement.unlocked ? 'url(#achievementGradient)' : 'rgba(255,255,255,0.1)'}"/>
  <text x="${x + 30}" y="${y + 42}" text-anchor="middle" fill="${achievement.unlocked ? 'black' : 'rgba(255,255,255,0.3)'}" font-size="16">${achievement.icon}</text>
  <text x="${x + 70}" y="${y + 25}" fill="${achievement.unlocked ? '#FFD700' : 'rgba(255,255,255,0.7)'}" font-family="Arial, sans-serif" font-size="18" font-weight="bold">${achievement.name}</text>
  <text x="${x + 70}" y="${y + 45}" fill="${achievement.unlocked ? 'white' : 'rgba(255,255,255,0.5)'}" font-family="Arial, sans-serif" font-size="14">${achievement.unlocked ? 'UNLOCKED' : 'IN PROGRESS'}</text>
  <!-- Progress Bar -->
  <rect x="${x + 70}" y="${y + 60}" width="200" height="8" rx="4" fill="rgba(255,255,255,0.1)"/>
  <rect x="${x + 70}" y="${y + 60}" width="${achievement.progress * 2}" height="8" rx="4" fill="url(#creditGradient)"/>
  <text x="${x + 70}" y="${y + 85}" fill="rgba(255,255,255,0.7)" font-family="Arial, sans-serif" font-size="12">${achievement.progress.toFixed(0)}% Complete</text>`;
            });

            content += `
  <text x="400" y="500" text-anchor="middle" fill="rgba(255,255,255,0.5)" font-family="Arial, sans-serif" font-size="14">Generated ${new Date().toLocaleString()}</text>`;

            const svg = generateSVG(content, 800, 550);
            downloadSVG(`achievements-${Date.now()}.svg`, svg);
        }

        function exportProgressChart() {
            const maxCredits = Math.max(gameState.credits, 1000);
            const maxXP = Math.max(gameState.xp, 500);

            const content = `
  <text x="400" y="50" text-anchor="middle" fill="url(#creditGradient)" font-family="Arial, sans-serif" font-size="32" font-weight="bold">Progress Statistics</text>

  <!-- Credits Bar -->
  <text x="100" y="120" fill="#00d4ff" font-family="Arial, sans-serif" font-size="20" font-weight="bold">üí∞ Credits: ${gameState.credits.toLocaleString()}</text>
  <rect x="100" y="130" width="600" height="30" rx="15" fill="rgba(255,255,255,0.1)"/>
  <rect x="100" y="130" width="${Math.min((gameState.credits / maxCredits) * 600, 600)}" height="30" rx="15" fill="url(#creditGradient)"/>

  <!-- XP Bar -->
  <text x="100" y="200" fill="#4ecdc4" font-family="Arial, sans-serif" font-size="20" font-weight="bold">‚ö° Experience: ${gameState.xp.toLocaleString()}</text>
  <rect x="100" y="210" width="600" height="30" rx="15" fill="rgba(255,255,255,0.1)"/>
  <rect x="100" y="210" width="${Math.min((gameState.xp / maxXP) * 600, 600)}" height="30" rx="15" fill="#4ecdc4"/>

  <!-- Level Progress -->
  <text x="100" y="280" fill="#ff6b6b" font-family="Arial, sans-serif" font-size="20" font-weight="bold">üéñÔ∏è Level ${gameState.level}</text>
  <text x="100" y="300" fill="rgba(255,255,255,0.7)" font-family="Arial, sans-serif" font-size="16">Next Level: ${((gameState.level * 1000) - gameState.xp)} XP remaining</text>
  <rect x="100" y="310" width="600" height="20" rx="10" fill="rgba(255,255,255,0.1)"/>
  <rect x="100" y="310" width="${((gameState.xp % 1000) / 1000) * 600}" height="20" rx="10" fill="#ff6b6b"/>

  <!-- Statistics Grid -->
  <rect x="100" y="370" width="600" height="120" rx="15" fill="rgba(255,255,255,0.05)" stroke="rgba(255,255,255,0.2)"/>
  <text x="120" y="400" fill="white" font-family="Arial, sans-serif" font-size="16" font-weight="bold">üìä Statistics Summary</text>

  <text x="120" y="430" fill="rgba(255,255,255,0.8)" font-family="Arial, sans-serif" font-size="14">Total Uploads: ${gameState.achievements.firstUpload ? '1+' : '0'}</text>
  <text x="120" y="450" fill="rgba(255,255,255,0.8)" font-family="Arial, sans-serif" font-size="14">Links Analyzed: ${gameState.achievements.linkMaster}</text>
  <text x="400" y="430" fill="rgba(255,255,255,0.8)" font-family="Arial, sans-serif" font-size="14">Sets Created: ${gameState.achievements.setOrganizer}</text>
  <text x="400" y="450" fill="rgba(255,255,255,0.8)" font-family="Arial, sans-serif" font-size="14">Credits per Level: ${(gameState.credits / Math.max(gameState.level, 1)).toFixed(0)}</text>

  <text x="400" y="530" text-anchor="middle" fill="rgba(255,255,255,0.5)" font-family="Arial, sans-serif" font-size="14">Generated ${new Date().toLocaleString()}</text>`;

            const svg = generateSVG(content, 800, 580);
            downloadSVG(`progress-chart-${Date.now()}.svg`, svg);
        }

        function exportPhotoAnalysis() {
            if (!lastPhotoAnalysis) {
                showNotification('No photo analysis data available. Upload a photo first!', 'error');
                return;
            }

            const content = `
  <text x="400" y="50" text-anchor="middle" fill="url(#creditGradient)" font-family="Arial, sans-serif" font-size="32" font-weight="bold">Photo Analysis Results</text>

  <!-- Analysis Levels -->
  <text x="100" y="120" fill="white" font-family="Arial, sans-serif" font-size="20" font-weight="bold">üì∏ AI Analysis Breakdown</text>

  <!-- Level 1 -->
  <rect x="100" y="140" width="600" height="60" rx="10" fill="rgba(76, 175, 80, 0.1)" stroke="#4CAF50"/>
  <text x="120" y="165" fill="#4CAF50" font-family="Arial, sans-serif" font-size="16" font-weight="bold">Level 1 - Basic Detection</text>
  <text x="120" y="185" fill="rgba(255,255,255,0.8)" font-family="Arial, sans-serif" font-size="14">Objects, colors, basic composition (+100 credits)</text>

  <!-- Level 2 -->
  <rect x="100" y="210" width="600" height="60" rx="10" fill="rgba(33, 150, 243, 0.1)" stroke="#2196F3"/>
  <text x="120" y="235" fill="#2196F3" font-family="Arial, sans-serif" font-size="16" font-weight="bold">Level 2 - Intermediate Analysis</text>
  <text x="120" y="255" fill="rgba(255,255,255,0.8)" font-family="Arial, sans-serif" font-size="14">Lighting, composition rules, depth analysis (+250 credits)</text>

  <!-- Level 3 -->
  <rect x="100" y="280" width="600" height="60" rx="10" fill="rgba(255, 152, 0, 0.1)" stroke="#FF9800"/>
  <text x="120" y="305" fill="#FF9800" font-family="Arial, sans-serif" font-size="16" font-weight="bold">Level 3 - Advanced Recognition</text>
  <text x="120" y="325" fill="rgba(255,255,255,0.8)" font-family="Arial, sans-serif" font-size="14">Mood detection, artistic elements, emotional context (+500 credits)</text>

  <!-- Level 4 -->
  <rect x="100" y="350" width="600" height="60" rx="10" fill="rgba(233, 30, 99, 0.1)" stroke="#E91E63"/>
  <text x="120" y="375" fill="#E91E63" font-family="Arial, sans-serif" font-size="16" font-weight="bold">Level 4 - Expert AI Insights</text>
  <text x="120" y="395" fill="rgba(255,255,255,0.8)" font-family="Arial, sans-serif" font-size="14">Complex pattern recognition, AI-generated insights (+750 credits)</text>

  <!-- Total -->
  <rect x="100" y="440" width="600" height="60" rx="10" fill="rgba(0, 212, 255, 0.1)" stroke="#00d4ff"/>
  <text x="120" y="465" fill="#00d4ff" font-family="Arial, sans-serif" font-size="18" font-weight="bold">Total Credits Earned: 1,600</text>
  <text x="120" y="485" fill="rgba(255,255,255,0.8)" font-family="Arial, sans-serif" font-size="14">Complete 4-level analysis completed successfully</text>

  <text x="400" y="530" text-anchor="middle" fill="rgba(255,255,255,0.5)" font-family="Arial, sans-serif" font-size="14">Generated ${new Date().toLocaleString()}</text>`;

            const svg = generateSVG(content, 800, 580);
            downloadSVG(`photo-analysis-${Date.now()}.svg`, svg);
        }

        function exportTimeline() {
            // Create sample timeline data
            const timelineEvents = [
                { time: '2 min ago', event: 'Level 4 photo analysis completed', credits: 750, type: 'photo' },
                { time: '5 min ago', event: 'Link with 15 sections analyzed', credits: 1000, type: 'link' },
                { time: '10 min ago', event: 'Design set created', xp: 50, type: 'set' },
                { time: '15 min ago', event: 'First photo uploaded', credits: 100, type: 'achievement' }
            ];

            let content = `
  <text x="400" y="50" text-anchor="middle" fill="url(#creditGradient)" font-family="Arial, sans-serif" font-size="32" font-weight="bold">Activity Timeline</text>

  <!-- Timeline Line -->
  <line x1="150" y1="100" x2="150" y2="500" stroke="url(#creditGradient)" stroke-width="3"/>`;

            timelineEvents.forEach((event, index) => {
                const y = 120 + index * 90;
                const iconColor = event.type === 'photo' ? '#E91E63' : event.type === 'link' ? '#2196F3' : event.type === 'set' ? '#4CAF50' : '#FFD700';
                const icon = event.type === 'photo' ? 'üì∏' : event.type === 'link' ? 'üîó' : event.type === 'set' ? 'üìä' : 'üèÜ';

                content += `
  <!-- Timeline Event ${index + 1} -->
  <circle cx="150" cy="${y}" r="12" fill="${iconColor}"/>
  <text x="150" y="${y + 5}" text-anchor="middle" fill="white" font-size="12">${icon}</text>
  <rect x="180" y="${y - 25}" width="500" height="50" rx="8" fill="rgba(255,255,255,0.05)" stroke="rgba(255,255,255,0.2)"/>
  <text x="200" y="${y - 5}" fill="white" font-family="Arial, sans-serif" font-size="16" font-weight="bold">${event.event}</text>
  <text x="200" y="${y + 15}" fill="rgba(255,255,255,0.7)" font-family="Arial, sans-serif" font-size="14">${event.time}${event.credits ? ` ‚Ä¢ +${event.credits} credits` : ''}${event.xp ? ` ‚Ä¢ +${event.xp} XP` : ''}</text>`;
            });

            content += `
  <text x="400" y="530" text-anchor="middle" fill="rgba(255,255,255,0.5)" font-family="Arial, sans-serif" font-size="14">Generated ${new Date().toLocaleString()}</text>`;

            const svg = generateSVG(content, 800, 580);
            downloadSVG(`activity-timeline-${Date.now()}.svg`, svg);
        }

        // Track photo analysis for export
        function analyzePhoto(file) {
            lastPhotoAnalysis = {
                filename: file.name,
                size: file.size,
                type: file.type,
                timestamp: new Date(),
                levels: [100, 250, 500, 750]
            };

            // Add to activity history
            activityHistory.unshift({
                type: 'photo',
                timestamp: new Date(),
                details: `Photo analysis: ${file.name}`,
                credits: 1600
            });

            showNotification('Analyzing photo...', 'credits');

            // Simulate AI analysis with progressive levels
            setTimeout(() => activateLevel('level1', 100), 500);
            setTimeout(() => activateLevel('level2', 250), 1000);
            setTimeout(() => activateLevel('level3', 500), 1500);
            setTimeout(() => activateLevel('level4', 750), 2000);

            // Check first upload achievement
            if (!gameState.achievements.firstUpload) {
                gameState.achievements.firstUpload = true;
                unlockAchievement('achievement1', 'First Upload Unlocked!');
            }
        }
    </script>
</body>
</html>